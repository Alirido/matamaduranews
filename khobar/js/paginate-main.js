var TuxAjaxPaging=function($){var init=function(mapVars){function debounce(a,t,n){var o;return function(){var i=this,e=arguments,p=function(){o=null,n||a.apply(i,e)},m=n&&!o;clearTimeout(o),o=setTimeout(p,t),m&&a.apply(i,e)}}var mymapAjaxLoader=mapVars.mapAjaxLoader,mymapCssLoadMore=mapVars.mapCssLoadMore,mymapCssLoadMoreButton=mapVars.mapCssLoadMoreButton,mymapInfiniteScrollBuffer=mapVars.mapInfiniteScrollBuffer,mymapLoadingTimer="",mymapLoadingMorePostsText=mapVars.mapLoadingMorePostsText,mymapLoadMoreButtonText=mapVars.mapLoadMoreButtonText,mymapPaginationClass=mapVars.mapPaginationClass,mymapPaginationClassPixelsToDocBottom=mapVars.mapPaginationClassPixelsToDocBottom,mymapPagingType=mapVars.mapPagingType,mymapPostsWrapperClass=mapVars.mapPostsWrapperClass,mymapPostClass=mapVars.mapPostClass,mymapNextPageSelector=mapVars.mapNextPageSelector,mymapNextPageUrl=mapVars.mapNextPageUrl,mymapPaginatorCount=mapVars.mapPaginatorCount,mymapUserCallback=mapVars.mapUserCallback,infiniteScrollRunning=!1,mapLoadPosts=function(){$.ajax({type:"GET",url:mymapNextPageUrl,dataType:"html",beforeSend:function(){var a=new CustomEvent("tuxLoadPostsStart");document.dispatchEvent(a)},success:function(a){var t=$.parseHTML(a),n=($(t).find(mymapPostsWrapperClass),mapPaginatorTotalCount(t));mapAddPaginatorCount(t,n);var o=$(t).find(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"] '+mymapPostClass),i=$(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"] '+mymapPostClass).last(),e=$(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"] '+mymapPostClass);if(i.after(o),"infinite-scroll"!=mymapPagingType&&"load-more"!=mymapPagingType||(1==n?mapIsLastPage(t,mymapNextPageSelector)?mymapNextPageUrl=$(t).find(mymapNextPageSelector).attr("href"):($('#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]').parent().remove(),window.removeEventListener("scroll",mapInfiniteScroll)):mapIsLastPage(t,mymapNextPageSelector+'[data-paginator-count="'+mymapPaginatorCount+'"]')?mymapNextPageUrl=$(t).find(mymapNextPageSelector+'[data-paginator-count="'+mymapPaginatorCount+'"]').attr("href"):($('#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]').parent().remove(),window.removeEventListener("scroll",mapInfiniteScroll))),"pagination"==mymapPagingType){e.remove(),history.pushState(null,null,mymapNextPageUrl);var p=$(t).find(mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').first();$(mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').replaceWith(p)}mapLoaded()},error:function(a,t){mapFailed()},complete:function(requestObj){var tuxloadPostsCompleteEvent=new CustomEvent("tuxLoadPostsComplete");document.dispatchEvent(tuxloadPostsCompleteEvent),"pagination"==mymapPagingType&&$("body,html").animate({scrollTop:$(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').offset().top-150},400),"infinite-scroll"==mymapPagingType&&(infiniteScrollRunning=!1),"load-more"==mymapPagingType&&$('#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]').removeClass("tux-load-more__button-disable");var mapResponse=$.parseHTML(requestObj.responseText),paginatorTotalCountAjax=mapPaginatorTotalCount(mapResponse);mapAddPaginatorCount(mapResponse,paginatorTotalCountAjax);var $mapLoadedPosts=$(mapResponse).find(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"] '+mymapPostClass);!function(loadedPosts,url){eval(mymapUserCallback)}($mapLoadedPosts,this.url)}})},mapPaginatorTotalCount=function(a){var t=0;for(var n in tuxSettings)$(a).find(tuxSettings[n].posts_wrapper).length&&$(a).find(tuxSettings[n].post_wrapper).length&&$(a).find(tuxSettings[n].pagination_wrapper).length&&t++;return t},mapAddPaginatorCount=function(a,t){var n=1;for(var o in tuxSettings)$(a).find(tuxSettings[o].posts_wrapper).length&&$(a).find(tuxSettings[o].post_wrapper).length&&$(a).find(tuxSettings[o].pagination_wrapper).length&&(1==t?($(a).find(tuxSettings[o].posts_wrapper).attr("data-paginator-count",n),$(a).find(tuxSettings[o].pagination_wrapper).attr("data-paginator-count",n)):($(a).find(tuxSettings[o].posts_wrapper).attr("data-paginator-count",n),$(a).find(tuxSettings[o].posts_wrapper+" "+tuxSettings[o].pagination_wrapper).attr("data-paginator-count",n),$(a).find(tuxSettings[o].posts_wrapper+" "+tuxSettings[o].next_page_selector).attr("data-paginator-count",n),n++))},mapIsLastPage=function(a,t){return $(a).find(t).length},mapAddLoader=function(){$(mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').last().before('<div class="tux-ajax-pagination-loading" data-paginator-count="'+mymapPaginatorCount+'">'+mymapAjaxLoader+"</div>")},mapLoading=function(){$('.tux-ajax-pagination-loading[data-paginator-count="'+mymapPaginatorCount+'"]').show(),"load-more"!=mymapPagingType&&"infinite-scroll"!=mymapPagingType||$('#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]').text(mymapLoadingMorePostsText)},mapLoaded=function(){$('.tux-ajax-pagination-loading[data-paginator-count="'+mymapPaginatorCount+'"]').hide(),"load-more"!=mymapPagingType&&"infinite-scroll"!=mymapPagingType||$('#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]').text(mymapLoadMoreButtonText),clearTimeout(mymapLoadingTimer)},mapFailed=function(){$('.tux-ajax-pagination-loading[data-paginator-count="'+mymapPaginatorCount+'"]').hide(),clearTimeout(mymapLoadingTimer)},mapInfiniteScroll=debounce(function(){if(!infiniteScrollRunning){var a=($(document).height()-$(window).scrollTop()-$(window).height(),$(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').offset().top),t=$(mymapPostsWrapperClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').outerHeight();$(window).height()+$(window).scrollTop()+mymapInfiniteScrollBuffer>a+t&&(infiniteScrollRunning=!0,mapLoading(),mapLoadPosts())}},250);"infinite-scroll"==mymapPagingType?$(mymapNextPageSelector+'[data-paginator-count="'+mymapPaginatorCount+'"]').attr("href")&&(mapAddLoader(),$(mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').remove(),window.addEventListener("scroll",mapInfiniteScroll)):"load-more"==mymapPagingType?$(mymapNextPageSelector+'[data-paginator-count="'+mymapPaginatorCount+'"]').attr("href")&&($(mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"]').last().after('<div class="tux-load-more"><a href="'+mymapNextPageUrl+'" id="tux-ajax-pagination-button" class="tux-load-more__button" data-paginator-count="'+mymapPaginatorCount+'">'+mymapLoadMoreButtonText+"</a></div>"),mapAddLoader(),$(mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"]:not(:has(>a#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]))').remove(),$('#tux-ajax-pagination-button[data-paginator-count="'+mymapPaginatorCount+'"]').click(function(a){a.preventDefault(),$(this).addClass("tux-load-more__button-disable"),mymapLoadingTimer=setTimeout(mapLoading,750),mapLoadPosts()})):"pagination"==mymapPagingType&&(mapAddLoader(),$(document).on("click",mymapPaginationClass+'[data-paginator-count="'+mymapPaginatorCount+'"] a',function(a){a.preventDefault(),mymapLoadingTimer=setTimeout(mapLoading,750),mymapNextPageUrl=a.currentTarget.href,mapLoadPosts()}),window.addEventListener("popstate",function(a){mymapNextPageUrl=document.URL,mapLoadPosts()}))},setUp=function(){var a=0,t=1,n=0;for(var o in tuxSettings)$(tuxSettings[o].posts_wrapper).length&&$(tuxSettings[o].post_wrapper).length&&$(tuxSettings[o].pagination_wrapper).length&&$(tuxSettings[o].next_page_selector).length&&n++;for(var o in tuxSettings)if($(tuxSettings[o].posts_wrapper).length&&$(tuxSettings[o].post_wrapper).length&&$(tuxSettings[o].pagination_wrapper).length&&$(tuxSettings[o].next_page_selector).length){1==n?($(tuxSettings[o].posts_wrapper).attr("data-paginator-count",t),$(tuxSettings[o].pagination_wrapper).attr("data-paginator-count",t),$(tuxSettings[o].next_page_selector).attr("data-paginator-count",t)):($(tuxSettings[o].posts_wrapper).attr("data-paginator-count",t),$(tuxSettings[o].posts_wrapper+" "+tuxSettings[o].pagination_wrapper).attr("data-paginator-count",t),$(tuxSettings[o].posts_wrapper+" "+tuxSettings[o].next_page_selector).attr("data-paginator-count",t),t++);var i={mapAjaxLoader:tuxSettings[o].ajax_loader,mapCssLoadMore:tuxSettings[o].tux_load_more,mapCssLoadMoreButton:tuxSettings[o].tux_load_more_button,mapInfiniteScrollBuffer:parseInt(tuxSettings[o].infinite_scroll_buffer),mapLoadingTimer:"",mapLoadingMorePostsText:tuxSettings[o].loading_more_posts_text,mapLoadMoreButtonText:tuxSettings[o].load_more_button_text,mapPaginationClass:tuxSettings[o].pagination_wrapper,mapPagingType:tuxSettings[o].paging_type,mapPostsWrapperClass:tuxSettings[o].posts_wrapper,mapPostClass:tuxSettings[o].post_wrapper,mapNextPageSelector:tuxSettings[o].next_page_selector,mapPaginatorCount:++a,mapUserCallback:tuxSettings[o].callback_function};i.mapPaginationClassPixelsToDocBottom=jQuery(document).height()-jQuery(i.mapPaginationClass).offset().top,1==n?i.mapNextPageUrl=$(tuxSettings[o].next_page_selector).attr("href"):i.mapNextPageUrl=$(tuxSettings[o].posts_wrapper+" "+tuxSettings[o].next_page_selector).attr("href"),init(i);var e=new CustomEvent("tuxPaginationInitialized");document.dispatchEvent(e)}};return setUp(),{setUp:setUp}}(jQuery);!function(){function a(a,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(a,t.bubbles,t.cancelable,t.detail),n}return"function"!=typeof window.CustomEvent&&(a.prototype=window.Event.prototype,void(window.CustomEvent=a))}();